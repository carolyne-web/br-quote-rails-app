<div class="bg-white shadow">
  <div class="px-4 sm:px-6 lg:max-w-7xl lg:mx-auto lg:px-8">
    <div class="py-6 md:flex md:items-center md:justify-between">
      <div class="flex-1 min-w-0">
        <h1 class="text-2xl font-bold leading-7 text-gray-900 sm:text-3xl sm:truncate">
          System Settings
        </h1>
      </div>
    </div>
  </div>
</div>

<div class="mt-8 space-y-8">
  <!-- Talent Categories Settings -->
  <div class="bg-white shadow overflow-hidden sm:rounded-lg">
    <div class="px-4 py-5 sm:px-6">
      <h3 class="text-lg leading-6 font-medium text-gray-900">
        Talent Category Base Rates
      </h3>
      <p class="mt-1 max-w-2xl text-sm text-gray-500">
        Set the base daily rates for each talent category
      </p>
    </div>
    <div class="border-t border-gray-200">
      <%= form_with url: bulk_update_admin_settings_path, method: :patch, local: true do |f| %>
        <dl>
          <% @talent_settings.each_with_index do |setting, index| %>
            <div class="<%= index.even? ? 'bg-gray-50' : 'bg-white' %> px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
              <dt class="text-sm font-medium text-gray-500">
                <%= setting.key.humanize.titleize %>
              </dt>
              <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2">
                <div class="flex items-center">
                  <span class="mr-2 text-gray-500">R</span>
                  <%= number_field_tag "settings[#{setting.id}]", setting.value,
                      class: "shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border-gray-300 rounded-md",
                      step: 100 %>
                </div>
              </dd>
            </div>
          <% end %>
        </dl>

        <div class="px-4 py-3 bg-gray-50 text-right sm:px-6">
          <%= f.submit "Update Talent Rates", class: "inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500" %>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Duration Settings -->
  <div class="bg-white shadow overflow-hidden sm:rounded-lg">
    <div class="px-4 py-5 sm:px-6">
      <h3 class="text-lg leading-6 font-medium text-gray-900">
        Duration Percentages
      </h3>
      <p class="mt-1 max-w-2xl text-sm text-gray-500">
        Set the percentage multipliers for different contract durations
      </p>
    </div>
    <div class="border-t border-gray-200">
      <%= form_with url: bulk_update_admin_settings_path, method: :patch, local: true do |f| %>
        <dl>
          <% @duration_settings.each_with_index do |setting, index| %>
            <div class="<%= index.even? ? 'bg-gray-50' : 'bg-white' %> px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
              <dt class="text-sm font-medium text-gray-500">
                <%= setting.key.gsub('duration_', '').humanize.titleize %>
              </dt>
              <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2">
                <div class="flex items-center">
                  <%= number_field_tag "settings[#{setting.id}]", setting.value,
                      class: "shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border-gray-300 rounded-md",
                      step: 10 %>
                  <span class="ml-2">%</span>
                </div>
              </dd>
            </div>
          <% end %>
        </dl>

        <div class="px-4 py-3 bg-gray-50 text-right sm:px-6">
          <%= f.submit "Update Duration Settings", class: "inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500" %>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Exclusivity Settings -->
  <div class="bg-white shadow overflow-hidden sm:rounded-lg">
    <div class="px-4 py-5 sm:px-6">
      <h3 class="text-lg leading-6 font-medium text-gray-900">
        Exclusivity Rates
      </h3>
      <p class="mt-1 max-w-2xl text-gray-500">
        Manage exclusivity types and their percentage multipliers
      </p>
    </div>
    
    <div class="border-t border-gray-200">
      <% if @exclusivity_settings.any? %>
        <!-- Existing Exclusivity Types -->
        <div class="bg-white">
          <%= form_with url: bulk_update_admin_settings_path, method: :patch, local: true do |f| %>
            <div class="divide-y divide-gray-200">
              <% @exclusivity_settings.each do |setting| %>
                <div class="px-6 py-4 flex items-center justify-between hover:bg-gray-50 transition-colors">
                  <div class="flex-1">
                    <div class="flex items-center space-x-4">
                      <!-- Category Name -->
                      <div class="min-w-0 flex-1">
                        <h4 class="text-sm font-medium text-gray-900">
                          <%= setting.key.gsub('exclusivity_', '').humanize.titleize %>
                        </h4>
                        <p class="text-xs text-gray-500">
                          Key: <%= setting.key %>
                        </p>
                      </div>
                      
                      <!-- Percentage Input -->
                      <div class="flex items-center space-x-2">
                        <%= number_field_tag "settings[#{setting.id}]", setting.value,
                            class: "w-20 px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",
                            step: 5, min: 0, max: 500 %>
                        <span class="text-sm text-gray-600 font-medium">%</span>
                      </div>
                    </div>
                  </div>
                  
                  <!-- Delete Button -->
                  <div class="ml-4">
                    <%= button_to admin_setting_path(setting), method: :delete,
                        data: { 
                          confirm: "Are you sure you want to delete '#{setting.key.gsub('exclusivity_', '').humanize.titleize}'? This cannot be undone."
                        },
                        class: "inline-flex items-center px-3 py-1.5 border border-red-300 text-xs font-medium rounded text-red-700 bg-red-50 hover:bg-red-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors" do %>
                      <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                      </svg>
                      Delete
                    <% end %>
                  </div>
                </div>
              <% end %>
            </div>

            <!-- Update Button -->
            <div class="px-6 py-4 bg-gray-50 border-t border-gray-200">
              <div class="flex justify-end">
                <%= f.submit "Update All Rates", class: "inline-flex justify-center items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors" %>
              </div>
            </div>
          <% end %>
        </div>
        
        <!-- Add New Exclusivity -->
        <div class="border-t-2 border-gray-100 bg-gray-50 px-6 py-5">
          <div class="mb-3">
            <h4 class="text-sm font-semibold text-gray-900">Add New Exclusivity Type</h4>
            <p class="text-xs text-gray-500 mt-1">Create a new exclusivity category for quotations</p>
          </div>
          
          <%= form_with url: admin_settings_path, method: :post, local: true, class: "space-y-4" do |f| %>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
              <div class="md:col-span-2">
                <%= f.label :exclusivity_name, "Category Name", class: "block text-xs font-medium text-gray-700 mb-1" %>
                <%= f.text_field :exclusivity_name, 
                    placeholder: "e.g., Premium Brand, Pharmaceutical, Luxury Tier", 
                    class: "w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",
                    required: true %>
              </div>
              
              <div>
                <%= f.label :exclusivity_percentage, "Percentage", class: "block text-xs font-medium text-gray-700 mb-1" %>
                <div class="flex items-center">
                  <%= f.number_field :exclusivity_percentage, 
                      step: 5, min: 0, max: 500, placeholder: "25", 
                      class: "w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",
                      required: true %>
                  <span class="ml-2 text-sm text-gray-600 font-medium">%</span>
                </div>
              </div>
            </div>
            
            <div class="flex justify-end">
              <%= f.submit "Add Exclusivity Type", class: "inline-flex justify-center items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors" %>
            </div>
          <% end %>
        </div>
      <% else %>
        <!-- Empty State -->
        <div class="px-6 py-12 text-center">
          <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
          </svg>
          <h3 class="mt-2 text-sm font-medium text-gray-900">No exclusivity types</h3>
          <p class="mt-1 text-sm text-gray-500">Get started by creating your first exclusivity category.</p>
          
          <!-- Add First Exclusivity -->
          <div class="mt-6 max-w-md mx-auto">
            <%= form_with url: admin_settings_path, method: :post, local: true, class: "space-y-4" do |f| %>
              <div>
                <%= f.label :exclusivity_name, "Category Name", class: "block text-xs font-medium text-gray-700 mb-1" %>
                <%= f.text_field :exclusivity_name, 
                    placeholder: "e.g., None, Category, Premium", 
                    class: "w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",
                    required: true %>
              </div>
              
              <div>
                <%= f.label :exclusivity_percentage, "Percentage", class: "block text-xs font-medium text-gray-700 mb-1" %>
                <div class="flex items-center">
                  <%= f.number_field :exclusivity_percentage, 
                      step: 5, min: 0, max: 500, placeholder: "0", 
                      class: "w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",
                      required: true %>
                  <span class="ml-2 text-sm text-gray-600 font-medium">%</span>
                </div>
              </div>
              
              <div>
                <%= f.submit "Create First Exclusivity Type", class: "w-full inline-flex justify-center items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors" %>
              </div>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Media Type Multipliers -->
  <div class="bg-white shadow overflow-hidden sm:rounded-lg">
    <div class="px-4 py-5 sm:px-6">
      <h3 class="text-lg leading-6 font-medium text-gray-900">
        Media Type Multipliers
      </h3>
      <p class="mt-1 max-w-2xl text-sm text-gray-500">
        Set the percentage multipliers for different media types (1 media = 50%, 2 media = 75%, 3+ media = 100%)
      </p>
    </div>
    <div class="border-t border-gray-200">
      <%= form_with url: bulk_update_admin_settings_path, method: :patch, local: true do |f| %>
        <dl>
          <% @media_settings.each_with_index do |setting, index| %>
            <div class="<%= index.even? ? 'bg-gray-50' : 'bg-white' %> px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
              <dt class="text-sm font-medium text-gray-500">
                <%= setting.key.gsub('media_', '').humanize.titleize %>
              </dt>
              <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2">
                <div class="flex items-center">
                  <%= number_field_tag "settings[#{setting.id}]", setting.value,
                      class: "shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border-gray-300 rounded-md",
                      step: 5, min: 0, max: 100 %>
                  <span class="ml-2">%</span>
                </div>
              </dd>
            </div>
          <% end %>
        </dl>

        <div class="px-4 py-3 bg-gray-50 text-right sm:px-6">
          <%= f.submit "Update Media Type Settings", class: "inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500" %>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Product Type Rules -->
  <div class="bg-white shadow overflow-hidden sm:rounded-lg">
    <div class="px-4 py-5 sm:px-6">
      <h3 class="text-lg leading-6 font-medium text-gray-900">
        Product Type Rules
      </h3>
      <p class="mt-1 max-w-2xl text-sm text-gray-500">
        Configure Kids category adjustments for different product types
      </p>
    </div>
    <div class="border-t border-gray-200">
      <%= form_with url: bulk_update_admin_settings_path, method: :patch, local: true do |f| %>
        <dl>
          <% @product_type_settings.each_with_index do |setting, index| %>
            <div class="<%= index.even? ? 'bg-gray-50' : 'bg-white' %> px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
              <dt class="text-sm font-medium text-gray-500">
                <%= setting.key.gsub('product_type_', '').humanize.titleize %> Product
                <div class="text-xs text-gray-400 mt-1">Kids category adjustment</div>
              </dt>
              <dd class="mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2">
                <div class="flex items-center">
                  <%= number_field_tag "settings[#{setting.id}]", setting.value,
                      class: "shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border-gray-300 rounded-md",
                      step: 5, min: 0, max: 100 %>
                  <span class="ml-2">% of Kids buyout</span>
                </div>
                <div class="text-xs text-gray-500 mt-1">
                  <% case setting.key %>
                  <% when 'product_type_adult_kids_adjustment' %>
                    Adult products reduce Kids category buyout by this percentage
                  <% when 'product_type_family_kids_adjustment' %>
                    Family products reduce Kids category buyout by this percentage
                  <% end %>
                </div>
              </dd>
            </div>
          <% end %>
        </dl>

        <div class="px-4 py-3 bg-gray-50 text-right sm:px-6">
          <%= f.submit "Update Product Type Rules", class: "inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500" %>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Territories Management -->
  <div class="bg-white shadow overflow-hidden sm:rounded-lg">
    <div class="px-4 py-5 sm:px-6 flex justify-between items-center">
      <div>
        <h3 class="text-lg leading-6 font-medium text-gray-900">
          Territory Percentages
        </h3>
        <p class="mt-1 max-w-2xl text-sm text-gray-500">
          Manage territories and their percentage multipliers
        </p>
      </div>
      <%= link_to "Manage Territories", admin_territories_path, class: "inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700" %>
    </div>
  </div>
</div>
